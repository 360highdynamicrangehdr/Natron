# Natron presets file
PluginID: fr.inria.built-in.Group
Params:
  - ScriptName: pyPlugPluginID
    String: fr.inria.LightWrap
  - ScriptName: pyPlugPluginLabel
    String: LightWrap
  - ScriptName: pyPlugPluginGrouping
    String: Draw
  - ScriptName: pyPlugPluginDescription
    String: "LightWrap helps composite objects onto a bright background by simulating reflections from the background light on the foreground, around its edges. Input A is the foreground image and its matte, and input B the the background to use for the wrapping effect.\n\nThe output of LightWrap should then be composited over the background to give the final composite."
  - ScriptName: pyPlugPluginVersion
    Int: [1, 0]
UserPages:
  - TypeName: Page
    ScriptName: controlsPage
    Label: Controls
    Params:
      - ScriptName: diffuse
        DefaultFloat: [15, 15]
        NDims: 2
        TypeName: Double
        Label: Diffuse
        Hint: Size of the reflections from the background to the foreground element (Intensity controls their intensity). Start by setting Diffuse to zero and adjust intensity to see what colors from the background are being reflected. Then adjust Diffuse, come back to Intensity if necessary, and balance both parameters until the result is satisfactory.
        Min: 0
        Max: 1000
        DisplayMin: 0
        DisplayMax: 100
      - ScriptName: intensity
        DefaultFloat: 0
        NDims: 1
        TypeName: Double
        Label: Intensity
        Hint: Brightness of the reflections from the background to the foreground element (Diffuse controls their size). Start by setting Diffuse to zero and adjust intensity to see what colors from the background are being reflected. Then adjust Diffuse, come back to Intensity if necessary, and balance both parameters until the result is satisfactory.
        Min: 0
        Max: 100
        DisplayMin: 0
        DisplayMax: 100
      - ScriptName: onlyWrap
        DefaultBool: false
        NDims: 1
        TypeName: Bool
        Label: Generate Wrap Only
        Hint: When checked, the LightWrap in generated but is not merged with the foreground object (disables the Highlight Merge).
      - ScriptName: disableLuma
        DefaultBool: false
        NDims: 1
        TypeName: Bool
        Label: Disable luminance-Based Wrap
        Hint: When checked, the LightWrap effect is created uniformly around the edged, rather than being controled by the color of the background.
      - ScriptName: enableGlow
        DefaultBool: false
        NDims: 1
        TypeName: Bool
        Label: Enable Glow
        Hint: When checked, the LightWrap is not masked by the foreground object, so that the objects seems to glow.
      - ScriptName: fgblur
        DefaultFloat: [1, 1]
        NDims: 2
        TypeName: Double
        Label: FGBlur
        Hint: Size of the blur applied to the alpha channel of the foreground (i.e. the foreground matte). More blur causes more background to be added to the foreground.
        Min: 0
        Max: 1000
        DisplayMin: 0
        DisplayMax: 100
      - ScriptName: fgblurBoundary
        DefaultString: Black
        NDims: 1
        TypeName: Choice
        Label: FGBlur Border Conditions
        Hint: Border conditions of the blur applied to the alpha channel of the foreground (i.e. the foreground matte). Use "Black" in most cases, and "Nearest" if the foreground matte should be extended beyond image borders when it touches them.
        Entries: [Black, Nearest]
        Hints: ["Dirichlet boundary condition: pixel values out of the image domain are zero.", "Neumann boundary condition: pixel values out of the image domain are those of the closest pixel location in the image domain."]
      - ScriptName: bgblur
        DefaultFloat: [0, 0]
        NDims: 2
        TypeName: Double
        Label: BGBlur
        Hint: Size of the blur applied to the background before merging it with the foreground element and applying the Diffuse blur.
        Min: 0
        Max: 1000
        DisplayMin: 0
        DisplayMax: 100
      - ScriptName: saturation
        DefaultFloat: 1
        NDims: 1
        TypeName: Double
        Label: Saturation
        Hint: Color saturation of the LightWrap effect. Advanced color correction parameters are available in the ColorCorrect tab.
        Min: -1.79769e+308
        Max: 1.79769e+308
        DisplayMin: 0
        DisplayMax: 4
      - ScriptName: lumaTolerance
        DefaultFloat: 0
        NDims: 1
        TypeName: Double
        Label: Luma Tolerance
        Hint: Luminance threshold of the LightWrap effect. Luminance values below this do not generate a LightWrap.
        Min: 0
        Max: 1
        DisplayMin: 0
        DisplayMax: 1
      - ScriptName: highlightmerge
        DefaultString: plus
        NDims: 1
        TypeName: Choice
        Label: Highlight Merge
        Hint: Merge operation bewteen the foreground object and the background. The default operation is "plus", which produces a glow effect.
        Entries: [atop, average, color, color-burn, color-dodge, conjoint-over, copy, difference, disjoint-over, divide, exclusion, freeze, from, geometric, grain-extract, grain-merge, hard-light, hue, hypot, in, luminosity, mask, matte, max, min, minus, multiply, out, over, overlay, pinlight, plus, reflect, saturation, screen, soft-light, stencil, under, xor]
        Hints: [Ab + B(1 - a) (a.k.a. src-atop), (A + B) / 2, "SetLum(A, Lum(B))", darken B towards A, brighten B towards A, "A + B(1-a)/b, A if a > b", A (a.k.a. src), abs(A-B) (a.k.a. absminus), "A+B(1-a)/b, A+B if a+b < 1", "A/B, 0 if A < 0 and B < 0", A+B-2AB, 1-sqrt(1-A)/B, B-A (a.k.a. subtract), 2AB/(A+B), B - A + 0.5, B + A - 0.5, "multiply if A < 0.5, screen if A > 0.5", "SetLum(SetSat(A, Sat(B)), Lum(B))", sqrt(A*A+B*B), Ab (a.k.a. src-in), "SetLum(B, Lum(A))", Ba (a.k.a dst-in), Aa + B(1-a) (unpremultiplied over), "max(A, B) (a.k.a. lighten only)", "min(A, B) (a.k.a. darken only)", A-B, "AB, 0 if A < 0 and B < 0", A(1-b) (a.k.a. src-out), A+B(1-a) (a.k.a. src-over), "multiply if B < 0.5, screen if B > 0.5", "if B >= 0.5 then max(A, 2*B - 1), min(A, B * 2.0 ) else", A+B (a.k.a. add), A*A / (1 - B), "SetLum(SetSat(B, Sat(A)), Lum(B))", "A+B-AB if A or B <= 1, otherwise max(A, B)", "burn-in if A < 0.5, lighten if A > 0.5", B(1-a) (a.k.a. dst-out), A(1-b)+B (a.k.a. dst-over), A(1-b)+B(1-a)]
        Props: [AnimatesChanged]
      - ScriptName: useConstant
        DefaultBool: false
        NDims: 1
        TypeName: Bool
        Label: Use Constant Highlight
        Hint: When checked, use a constant color (specified by the Constant parameter) instead of the background for the LightWrap effect.
        Props: [AnimatesChanged]
      - ScriptName: constantcolor
        DefaultFloat: [1, 1, 1, 1]
        NDims: 4
        TypeName: Color
        Label: Constant
        Hint: Color to use in the LightWrap effect when Use constant highlight is enabled.
        Max: 2147483647
        DisplayMax: 1
  - TypeName: Page
    ScriptName: colorCorrectPage
    Label: ColorCorrect
    Params:
      - TypeName: Group
        ScriptName: masterGroup
        Label: Master
        Params:
          - ScriptName: ColorCorrect1MasterSaturation
            DefaultFloat: [1, 1, 1, 1]
            NDims: 4
            TypeName: Color
            Label: Saturation
            Min: -1.79769e+308
            Max: 1.79769e+308
            DisplayMin: 0
            DisplayMax: 4
          - ScriptName: ColorCorrect1MasterContrast
            DefaultFloat: [1, 1, 1, 1]
            NDims: 4
            TypeName: Color
            Label: Contrast
            Min: -1.79769e+308
            Max: 1.79769e+308
            DisplayMin: 0
            DisplayMax: 4
          - ScriptName: ColorCorrect1MasterGamma
            DefaultFloat: [1, 1, 1, 1]
            NDims: 4
            TypeName: Color
            Label: Gamma
            Min: -1.79769e+308
            Max: 1.79769e+308
            DisplayMin: 0.2
            DisplayMax: 5
          - ScriptName: ColorCorrect1MasterGain
            DefaultFloat: [1, 1, 1, 1]
            NDims: 4
            TypeName: Color
            Label: Gain
            Min: -1.79769e+308
            Max: 1.79769e+308
            DisplayMin: 0
            DisplayMax: 4
          - ScriptName: ColorCorrect1MasterOffset
            DefaultFloat: [0, 0, 0, 0]
            NDims: 4
            TypeName: Color
            Label: Offset
            Min: -1.79769e+308
            Max: 1.79769e+308
            DisplayMin: -1
            DisplayMax: 1
        Props:
          - Opened
      - TypeName: Group
        ScriptName: shadowsGroup
        Label: Shadows
        Params:
          - ScriptName: ColorCorrect1ShadowsEnable
            DefaultBool: true
            NDims: 1
            TypeName: Bool
            Label: Enable
          - ScriptName: ColorCorrect1ShadowsSaturation
            DefaultFloat: [1, 1, 1, 1]
            NDims: 4
            TypeName: Color
            Label: Saturation
            Min: -1.79769e+308
            Max: 1.79769e+308
            DisplayMin: 0
            DisplayMax: 4
          - ScriptName: ColorCorrect1ShadowsContrast
            DefaultFloat: [1, 1, 1, 1]
            NDims: 4
            TypeName: Color
            Label: Contrast
            Min: -1.79769e+308
            Max: 1.79769e+308
            DisplayMin: 0
            DisplayMax: 4
          - ScriptName: ColorCorrect1ShadowsGamma
            DefaultFloat: [1, 1, 1, 1]
            NDims: 4
            TypeName: Color
            Label: Gamma
            Min: -1.79769e+308
            Max: 1.79769e+308
            DisplayMin: 0.2
            DisplayMax: 5
          - ScriptName: ColorCorrect1ShadowsGain
            DefaultFloat: [1, 1, 1, 1]
            NDims: 4
            TypeName: Color
            Label: Gain
            Min: -1.79769e+308
            Max: 1.79769e+308
            DisplayMin: 0
            DisplayMax: 4
          - ScriptName: ColorCorrect1ShadowsOffset
            DefaultFloat: [0, 0, 0, 0]
            NDims: 4
            TypeName: Color
            Label: Offset
            Min: -1.79769e+308
            Max: 1.79769e+308
            DisplayMin: -1
            DisplayMax: 1
        Props:
          - Opened
      - TypeName: Group
        ScriptName: midtonesGroup
        Label: Midtones
        Params:
          - ScriptName: ColorCorrect1MidtonesEnable
            DefaultBool: true
            NDims: 1
            TypeName: Bool
            Label: Enable
          - ScriptName: ColorCorrect1MidtonesSaturation
            DefaultFloat: [1, 1, 1, 1]
            NDims: 4
            TypeName: Color
            Label: Saturation
            Min: -1.79769e+308
            Max: 1.79769e+308
            DisplayMin: 0
            DisplayMax: 4
          - ScriptName: ColorCorrect1MidtonesContrast
            DefaultFloat: [1, 1, 1, 1]
            NDims: 4
            TypeName: Color
            Label: Contrast
            Min: -1.79769e+308
            Max: 1.79769e+308
            DisplayMin: 0
            DisplayMax: 4
          - ScriptName: ColorCorrect1MidtonesGamma
            DefaultFloat: [1, 1, 1, 1]
            NDims: 4
            TypeName: Color
            Label: Gamma
            Min: -1.79769e+308
            Max: 1.79769e+308
            DisplayMin: 0.2
            DisplayMax: 5
          - ScriptName: ColorCorrect1MidtonesGain
            DefaultFloat: [1, 1, 1, 1]
            NDims: 4
            TypeName: Color
            Label: Gain
            Min: -1.79769e+308
            Max: 1.79769e+308
            DisplayMin: 0
            DisplayMax: 4
          - ScriptName: ColorCorrect1MidtonesOffset
            DefaultFloat: [0, 0, 0, 0]
            NDims: 4
            TypeName: Color
            Label: Offset
            Min: -1.79769e+308
            Max: 1.79769e+308
            DisplayMin: -1
            DisplayMax: 1
        Props:
          - Opened
      - TypeName: Group
        ScriptName: highlightsGroup
        Label: Highlights
        Params:
          - ScriptName: ColorCorrect1HighlightsEnable
            DefaultBool: true
            NDims: 1
            TypeName: Bool
            Label: Enable
          - ScriptName: ColorCorrect1HighlightsSaturation
            DefaultFloat: [1, 1, 1, 1]
            NDims: 4
            TypeName: Color
            Label: Saturation
            Min: -1.79769e+308
            Max: 1.79769e+308
            DisplayMin: 0
            DisplayMax: 4
          - ScriptName: ColorCorrect1HighlightsContrast
            DefaultFloat: [1, 1, 1, 1]
            NDims: 4
            TypeName: Color
            Label: Contrast
            Min: -1.79769e+308
            Max: 1.79769e+308
            DisplayMin: 0
            DisplayMax: 4
          - ScriptName: ColorCorrect1HighlightsGamma
            DefaultFloat: [1, 1, 1, 1]
            NDims: 4
            TypeName: Color
            Label: Gamma
            Min: -1.79769e+308
            Max: 1.79769e+308
            DisplayMin: 0.2
            DisplayMax: 5
          - ScriptName: ColorCorrect1HighlightsGain
            DefaultFloat: [1, 1, 1, 1]
            NDims: 4
            TypeName: Color
            Label: Gain
            Min: -1.79769e+308
            Max: 1.79769e+308
            DisplayMin: 0
            DisplayMax: 4
          - ScriptName: ColorCorrect1HighlightsOffset
            DefaultFloat: [0, 0, 0, 0]
            NDims: 4
            TypeName: Color
            Label: Offset
            Min: -1.79769e+308
            Max: 1.79769e+308
            DisplayMin: -1
            DisplayMax: 1
        Props:
          - Opened
PagesOrder: [controlsPage, colorCorrectPage, nodePage]
Children:
  - PluginID: fr.inria.built-in.Output
    ScriptName: Output
    Label: Output1
    Inputs: {Source: Dot4}
    Pos: [761, 1308]
  - PluginID: fr.inria.built-in.Input
    ScriptName: Input1
    Label: A
    Pos: [198, -35]
  - PluginID: net.sf.openfx.KeyerPlugin
    ScriptName: Keyer1
    Inputs: {Source: Dot1}
    Params:
      - ScriptName: softnessLower
        Float: {Expr: thisGroup.lumaTolerance.getValue() - 1}
      - ScriptName: softnessUpper
        Float: 0
    Pos: [752, 164]
  - PluginID: net.sf.openfx.Premult
    ScriptName: Premult1
    Version: [2, 0]
    Inputs: {Source: Keyer1}
    Pos: [752, 252]
  - PluginID: net.sf.cimg.CImgBlur
    ScriptName: BGBlur
    Version: [3, 0]
    Inputs: {Source: Premult1}
    Params:
      - ScriptName: NatronOfxParamProcessA
        Bool: true
      - ScriptName: size
        Props: [MasterIsAlias]
      - ScriptName: expandRoD
        Bool: false
    Pos: [752, 316]
  - PluginID: net.sf.openfx.ConstantPlugin
    ScriptName: Constant1
    Params:
      - ScriptName: NatronParamFormatChoice
        String: PC_Video 640x480
      - ScriptName: size
        Float: [960, 540]
      - ScriptName: color
        Float: 1
        Props: [MasterIsAlias]
      - ScriptName: NatronOfxParamProcessA
        Bool: false
    Pos: [968, 185]
  - PluginID: net.sf.openfx.ShufflePlugin
    ScriptName: Shufflecopy1
    Version: [2, 0]
    Inputs: {A: BGBlur, B: Constant1}
    Params:
      - ScriptName: outputChannelsChoice
        String: Color.RGBA
      - ScriptName: outputRChoice
        String: B.r
      - ScriptName: outputGChoice
        String: B.g
      - ScriptName: outputBChoice
        String: B.b
      - ScriptName: outputAChoice
        String: A.a
    Pos: [968, 316]
  - PluginID: net.sf.openfx.Premult
    ScriptName: Premult2
    Version: [2, 0]
    Inputs: {Source: Shufflecopy1}
    Pos: [970, 380]
  - PluginID: net.sf.openfx.switchPlugin
    ScriptName: DisableLuma
    Inputs: {0: Premult2, 1: Constant1}
    Params:
      - ScriptName: which
        Int: {Expr: thisGroup.disableLuma.getValue()}
    Pos: [1172, 380]
  - PluginID: net.sf.openfx.switchPlugin
    ScriptName: DisableLuma1
    Inputs: {0: BGBlur, 1: Keyer1}
    Params:
      - ScriptName: which
        Int: {Expr: thisGroup.disableLuma.getValue()}
    Pos: [579, 319]
  - PluginID: fr.inria.built-in.Dot
    ScriptName: Dot1
    Inputs: {"": Input2}
    Pos: [797, 21]
  - PluginID: net.sf.openfx.switchPlugin
    ScriptName: ConstantColor
    Inputs: {0: DisableLuma1, 1: DisableLuma}
    Params:
      - ScriptName: which
        Int: {Expr: thisGroup.useConstant.getValue()}
    Pos: [758, 448]
  - PluginID: fr.inria.built-in.Dot
    ScriptName: Dot2
    Inputs: {"": Input1}
    Pos: [243, 443]
  - PluginID: net.sf.cimg.CImgBlur
    ScriptName: FGBlur
    Version: [3, 0]
    Inputs: {Source: Dot2}
    Params:
      - ScriptName: NatronOfxParamProcessR
        Bool: false
      - ScriptName: NatronOfxParamProcessG
        Bool: false
      - ScriptName: NatronOfxParamProcessB
        Bool: false
      - ScriptName: NatronOfxParamProcessA
        Bool: true
      - ScriptName: size
        Float: 1
        Props: [MasterIsAlias]
      - ScriptName: boundary
        Props: [MasterIsAlias]
      - ScriptName: expandRoD
        Bool: false
    Pos: [434, 433]
  - PluginID: net.sf.openfx.MergePlugin
    ScriptName: EdgeMerge
    Inputs: {A: Dot2, B: FGBlur}
    Params:
      - ScriptName: operation
        String: out
      - ScriptName: AChannelsR
        Bool: false
      - ScriptName: AChannelsG
        Bool: false
      - ScriptName: AChannelsB
        Bool: false
      - ScriptName: OutputChannelsR
        Bool: false
      - ScriptName: OutputChannelsG
        Bool: false
      - ScriptName: OutputChannelsB
        Bool: false
    Pos: [434, 545]
  - PluginID: net.sf.openfx.MergePlugin
    ScriptName: MaskMerge
    Inputs: {A: ConstantColor, B: EdgeMerge}
    Params:
      - ScriptName: operation
        String: in
      - ScriptName: OutputChannelsA
        Bool: false
    Pos: [758, 545]
  - PluginID: net.sf.cimg.CImgBlur
    ScriptName: Diffuse
    Version: [3, 0]
    Inputs: {Source: MaskMerge}
    Params:
      - ScriptName: NatronOfxParamProcessA
        Bool: true
      - ScriptName: size
        Float: 15
        Props: [MasterIsAlias]
      - ScriptName: expandRoD
        Bool: false
    Pos: [758, 633]
  - PluginID: net.sf.openfx.MultiplyPlugin
    ScriptName: Intensity
    Version: [2, 0]
    Inputs: {Source: Diffuse}
    Params:
      - ScriptName: NatronOfxParamProcessA
        Bool: true
      - ScriptName: value
        Float: {Expr: thisGroup.intensity.getValue()}
    Pos: [758, 697]
  - PluginID: net.sf.openfx.SaturationPlugin
    ScriptName: Saturation1
    Version: [2, 0]
    Inputs: {Source: Intensity}
    Params:
      - ScriptName: saturation
        Props: [MasterIsAlias]
      - ScriptName: clampBlack
        Bool: false
    Pos: [758, 761]
  - PluginID: net.sf.openfx.ColorCorrectPlugin
    ScriptName: ColorCorrect1
    Version: [2, 0]
    Inputs: {Source: Saturation1}
    Params:
      - ScriptName: NatronOfxParamProcessA
        Bool: true
      - ScriptName: MasterSaturation
        Props: [MasterIsAlias]
      - ScriptName: MasterContrast
        Props: [MasterIsAlias]
      - ScriptName: MasterGamma
        Props: [MasterIsAlias]
      - ScriptName: MasterGain
        Props: [MasterIsAlias]
      - ScriptName: MasterOffset
        Props: [MasterIsAlias]
      - ScriptName: ShadowsEnable
        Props: [MasterIsAlias]
      - ScriptName: ShadowsSaturation
        Props: [MasterIsAlias]
      - ScriptName: ShadowsContrast
        Props: [MasterIsAlias]
      - ScriptName: ShadowsGamma
        Props: [MasterIsAlias]
      - ScriptName: ShadowsGain
        Props: [MasterIsAlias]
      - ScriptName: ShadowsOffset
        Props: [MasterIsAlias]
      - ScriptName: MidtonesEnable
        Props: [MasterIsAlias]
      - ScriptName: MidtonesSaturation
        Props: [MasterIsAlias]
      - ScriptName: MidtonesContrast
        Props: [MasterIsAlias]
      - ScriptName: MidtonesGamma
        Props: [MasterIsAlias]
      - ScriptName: MidtonesGain
        Props: [MasterIsAlias]
      - ScriptName: MidtonesOffset
        Props: [MasterIsAlias]
      - ScriptName: HighlightsEnable
        Props: [MasterIsAlias]
      - ScriptName: HighlightsSaturation
        Props: [MasterIsAlias]
      - ScriptName: HighlightsContrast
        Props: [MasterIsAlias]
      - ScriptName: HighlightsGamma
        Props: [MasterIsAlias]
      - ScriptName: HighlightsGain
        Props: [MasterIsAlias]
      - ScriptName: HighlightsOffset
        Props: [MasterIsAlias]
      - ScriptName: clampBlack
        Bool: false
    Pos: [758, 825]
  - PluginID: net.sf.openfx.MergePlugin
    ScriptName: MaskMerge2
    Inputs: {A: Dot2, B: ColorCorrect1}
    Params:
      - ScriptName: operation
        String: mask
      - ScriptName: disableNode
        Props: [MasterIsAlias]
    Pos: [761, 909]
  - PluginID: net.sf.openfx.ShufflePlugin
    ScriptName: Shuffle1
    Version: [2, 0]
    Inputs: {A: MaskMerge2}
    Params:
      - ScriptName: outputChannelsChoice
        String: Color.RGBA
      - ScriptName: outputRChoice
        String: A.r
      - ScriptName: outputGChoice
        String: A.g
      - ScriptName: outputBChoice
        String: A.b
      - ScriptName: outputAChoice
        String: 0
    Pos: [761, 1026]
  - PluginID: net.sf.openfx.MergePlugin
    ScriptName: HighlightMerge
    Inputs: {A: Dot2, B: Shuffle1}
    Params:
      - ScriptName: operation
        String: plus
        Props: [MasterIsAlias]
      - ScriptName: disableNode
        Props: [MasterIsAlias]
    Pos: [761, 1108]
  - PluginID: fr.inria.built-in.Dot
    ScriptName: Dot4
    Inputs: {"": HighlightMerge}
    Pos: [806, 1218]
  - PluginID: fr.inria.built-in.Input
    ScriptName: Input2
    Label: B
    Pos: [753, -43]